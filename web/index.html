<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Light Novel Machine Translation Robot</title>
    <meta
      name="description"
      content="Light Novel Machine Translation Robot is a website that can automatically generate and share machine-translated light novels. Here, you can browse Japanese web novels/wenku novels, or upload your own novel files for machine translation."
    />
    <link rel="icon" href="/favicon.ico" sizes="32x32" />
    <link rel="icon" href="/icon.svg" type="image/svg+xml" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="theme-color" content="white" />
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-QD8MZ90XFJ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-QD8MZ90XFJ');
    </script>
    <script>
      window.onerror = function (msg, url, lno, cno) {
        var div = document.createElement('div');
        div.innerHTML = `Error: ${lno}:${cno} ${msg
          .replace('<', '&lt;')
          .replace('>', '&gt;')} ${url}`;
        div.style.position = 'fixed';
        document.body.appendChild(div);
        return false;
      };
    </script>
    <script>
      (() => {
        function applyTheme(toolbarColor, backgroundColor) {
          document.querySelector("meta[name='theme-color']").content =
            toolbarColor;

          const style = document.createElement('style');
          style.innerHTML = `body { background-color: ${backgroundColor}; }`;
          document.head.appendChild(style);
        }
        function getAndApplyTheme() {
          const reg = [
            /\/novel\/(\w+)\/(\w+)\/(\w+)/,
            /\/workspace\/reader\/(\w+)\/(\w+)/,
          ];
          const isReader = reg.some((r) => r.test(window.location.pathname));
          const setting = localStorage.getItem(
            isReader ? 'readerSetting' : 'setting',
          );
          if (!setting) return;
          const json = JSON.parse(setting);
          let theme = isReader ? json.theme.mode : json.theme;
          if (!theme) theme = 'system';
          if (theme === 'custom') {
            applyTheme(json.theme.bodyColor, json.theme.bodyColor);
          } else if (
            theme === 'dark' ||
            (theme === 'system' &&
              window.matchMedia('(prefers-color-scheme: dark)').matches)
          ) {
            applyTheme('rgb(24, 24, 28)', 'rgb(16, 16, 20)');
          } else {
            applyTheme('white', 'white');
          }
        }
        getAndApplyTheme();
        if (window.history) {
          const oldPushState = history.pushState;
          history.pushState = function pushState() {
            const ret = oldPushState.apply(this, arguments);
            getAndApplyTheme();
            return ret;
          };
          window.addEventListener('popstate', () => {
            getAndApplyTheme();
          });
        }
      })();
    </script>
    <script>
      // vite bug, see https://github.com/vitejs/vite/discussions/15794
      if (!('hasOwn' in Object)) {
        Object.hasOwn = Object.call.bind(Object.hasOwnProperty);
      }
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
    <noscript>
      <p>This page requires JavaScript to be enabled in your browser.</p>
      <p>If it's already enabled, then... my friend, you should update your browser.</p>
    </noscript>
  </body>
</html>
